<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <title>WebDALI</title>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <style type="text/css">
    .light-widget { margin: 10px 10px 15px 10px; }
  </style>
  <script type="text/javascript" src="../lib/jqueryui/js/jquery-1.7.2.min.js"></script>
  <script type="text/javascript" src="../lib/underscore.js"></script>
  <script type="text/javascript" src="../lib/backbone.js"></script>
  <script type="text/javascript" src="../lib/jqueryui/js/jquery-ui-1.8.21.custom.min.js"></script>
  <script type="text/javascript" src="../lib/jstree/jquery.jstree.js"></script>
  <script type="text/javascript" src="light.js"></script>
  <script type="text/javascript" src="program.js"></script>
  <script type="text/javascript" src="programline.js"></script>
  <script type="text/javascript" src="programlist.js"></script>
  <link rel="stylesheet" href="../lib/jqueryui/css/ui-lightness/jquery-ui-1.8.21.custom.css" />

</head>
<body>
  <div id="programMenu"></div>
  <div id="lightsList"></div>
  <div id="programList"></div>
  <script type="text/javascript">
    Backbone.emulateHTTP = true;
    var Programs = new ProgramList.ProgramList;

    var AppRouter = Backbone.Router.extend ({
	routes: {
	    "programs": "programsView",
	    "controls": "controlsView",
	    "test": "testView",
	    "": "programsView"
	},

	programsView: function () {
	    var ProgramMenu = new ProgramList.SingleChoiceMenu({ model: Programs, el: $("#programMenu") });

	    $.jstree._themes="../lib/jstree/themes/";
	    var testTree = $("#lightsList").jstree ({
		"json_data": {
		    "ajax": {
			"url": "../server/lights"
		    }
		},
		"checkbox": {
		    "two_state": "true"
		},
		"plugins": ["themes", "json_data", "checkbox", ]});
	},

	testView: function () {
	    $("body").append ("<div id='testLight'></div>");

	    var LightCollectionTest = Backbone.Collection.extend ({
		model: Light.Light,
		url: "../server/lightsFlat"
	    });
	    
	    var Lights = new LightCollectionTest;

	    var ProgramObj = new ProgramLine.ProgramLine({name: "ohjelma"});
	    var ProgramView = new ProgramLine.ProgramLineView ({el: $("#testLight"), model: ProgramObj});
	    
	    Lights.fetch( { success: function (lights, response) { lights.each (function (light) {ProgramView.addLight (light)})}});
	}
	
    });
    var appRouter = new AppRouter;
    Backbone.history.start();
/*

*/

</script>
</body>
</html>
